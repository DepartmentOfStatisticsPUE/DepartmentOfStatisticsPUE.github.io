<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>5 Regresja | Statystyka opisowa</title>
  <meta name="description" content="5 Regresja | Statystyka opisowa">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="5 Regresja | Statystyka opisowa" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Regresja | Statystyka opisowa" />
  
  
  

<meta name="author" content="Katedra Statystyki">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="korelacje.html">
<link rel="next" href="sezonowosc.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Wprowadzenie</a></li>
<li class="chapter" data-level="1" data-path="zbiorowosc.html"><a href="zbiorowosc.html"><i class="fa fa-check"></i><b>1</b> Zbiorowość, jednostka, cecha</a><ul>
<li class="chapter" data-level="1.1" data-path="zbiorowosc.html"><a href="zbiorowosc.html#zbiory-danych"><i class="fa fa-check"></i><b>1.1</b> Zbiory danych</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html"><i class="fa fa-check"></i><b>2</b> Wizualizacja danych</a><ul>
<li class="chapter" data-level="2.1" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#rodzaje-rozkadow"><i class="fa fa-check"></i><b>2.1</b> Rodzaje rozkładów</a></li>
<li class="chapter" data-level="2.2" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#szeregi-statystyczne"><i class="fa fa-check"></i><b>2.2</b> Szeregi statystyczne</a></li>
<li class="chapter" data-level="2.3" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#dystrybuanta"><i class="fa fa-check"></i><b>2.3</b> Dystrybuanta</a></li>
<li class="chapter" data-level="2.4" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#histogramy"><i class="fa fa-check"></i><b>2.4</b> Histogramy</a><ul>
<li class="chapter" data-level="2.4.1" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-arbitralnie-ustalanej-szerokosci-przedziaow"><i class="fa fa-check"></i><b>2.4.1</b> Metoda arbitralnie ustalanej szerokosci przedziałów</a></li>
<li class="chapter" data-level="2.4.2" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-pierwiastkowa"><i class="fa fa-check"></i><b>2.4.2</b> Metoda pierwiastkowa</a></li>
<li class="chapter" data-level="2.4.3" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-strugesa"><i class="fa fa-check"></i><b>2.4.3</b> Metoda Struges’a</a></li>
<li class="chapter" data-level="2.4.4" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-uniwersytetu-rice"><i class="fa fa-check"></i><b>2.4.4</b> Metoda Uniwersytetu Rice</a></li>
<li class="chapter" data-level="2.4.5" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-doanea"><i class="fa fa-check"></i><b>2.4.5</b> Metoda Doane’a</a></li>
<li class="chapter" data-level="2.4.6" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-scotta"><i class="fa fa-check"></i><b>2.4.6</b> Metoda Scott’a</a></li>
<li class="chapter" data-level="2.4.7" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-freedmanadiaconisa"><i class="fa fa-check"></i><b>2.4.7</b> Metoda Freedmana–Diaconis’a</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analiza-struktury.html"><a href="analiza-struktury.html"><i class="fa fa-check"></i><b>3</b> Analiza struktury</a><ul>
<li class="chapter" data-level="3.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-klasyczne"><i class="fa fa-check"></i><b>3.1</b> Miary klasyczne</a></li>
<li class="chapter" data-level="3.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-pozycyjne"><i class="fa fa-check"></i><b>3.2</b> Miary pozycyjne</a></li>
<li class="chapter" data-level="3.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#szereg-jednostkowy-i-przedziaowy"><i class="fa fa-check"></i><b>3.3</b> Szereg jednostkowy i przedziałowy</a><ul>
<li class="chapter" data-level="3.3.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#szereg-jednostkowy"><i class="fa fa-check"></i><b>3.3.1</b> Szereg jednostkowy</a></li>
<li class="chapter" data-level="3.3.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#szereg-przedziaowy"><i class="fa fa-check"></i><b>3.3.2</b> Szereg przedziałowy</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="analiza-struktury.html"><a href="analiza-struktury.html#podsumowanie-miar"><i class="fa fa-check"></i><b>3.4</b> Podsumowanie miar</a><ul>
<li class="chapter" data-level="3.4.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#schemat"><i class="fa fa-check"></i><b>3.4.1</b> Schemat</a></li>
<li class="chapter" data-level="3.4.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-klasyczne-1"><i class="fa fa-check"></i><b>3.4.2</b> Miary klasyczne</a></li>
<li class="chapter" data-level="3.4.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-pozycyjne-1"><i class="fa fa-check"></i><b>3.4.3</b> Miary pozycyjne</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="analiza-struktury.html"><a href="analiza-struktury.html#przedziay-ufnosci"><i class="fa fa-check"></i><b>3.5</b> Przedziały ufności</a><ul>
<li class="chapter" data-level="3.5.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#srednia-w-populacji-normalnej-ze-znanym-odchyleniem-standardowym"><i class="fa fa-check"></i><b>3.5.1</b> Średnia w populacji normalnej ze znanym odchyleniem standardowym</a></li>
<li class="chapter" data-level="3.5.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#srednia-w-populacji-normalnej-z-nieznanym-odchyleniem-standardowym---maa-proba"><i class="fa fa-check"></i><b>3.5.2</b> Średnia w populacji normalnej z nieznanym odchyleniem standardowym - mała próba</a></li>
<li class="chapter" data-level="3.5.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#srednia-w-populacji-normalnej-z-nieznanym-odchyleniem-standardowym---duza-proba"><i class="fa fa-check"></i><b>3.5.3</b> Średnia w populacji normalnej z nieznanym odchyleniem standardowym - duża próba</a></li>
<li class="chapter" data-level="3.5.4" data-path="analiza-struktury.html"><a href="analiza-struktury.html#proporcja"><i class="fa fa-check"></i><b>3.5.4</b> Proporcja</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="analiza-struktury.html"><a href="analiza-struktury.html#testy-statystyczne"><i class="fa fa-check"></i><b>3.6</b> Testy statystyczne</a><ul>
<li class="chapter" data-level="3.6.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-t-dla-jednej-sredniej"><i class="fa fa-check"></i><b>3.6.1</b> Test t dla jednej średniej</a></li>
<li class="chapter" data-level="3.6.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-t-dla-dwoch-srednich-niezaleznych"><i class="fa fa-check"></i><b>3.6.2</b> Test t dla dwóch średnich niezależnych</a></li>
<li class="chapter" data-level="3.6.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-istotnosci-proporcji"><i class="fa fa-check"></i><b>3.6.3</b> Test istotności proporcji</a></li>
<li class="chapter" data-level="3.6.4" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-istotnosci-dwoch-proporcji"><i class="fa fa-check"></i><b>3.6.4</b> Test istotności dwóch proporcji</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="korelacje.html"><a href="korelacje.html"><i class="fa fa-check"></i><b>4</b> Korelacje</a><ul>
<li class="chapter" data-level="4.1" data-path="korelacje.html"><a href="korelacje.html#cechy-jakosciowe"><i class="fa fa-check"></i><b>4.1</b> Cechy jakościowe</a></li>
<li class="chapter" data-level="4.2" data-path="korelacje.html"><a href="korelacje.html#cechy-ciage"><i class="fa fa-check"></i><b>4.2</b> Cechy ciągłe</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regresja.html"><a href="regresja.html"><i class="fa fa-check"></i><b>5</b> Regresja</a><ul>
<li class="chapter" data-level="5.1" data-path="regresja.html"><a href="regresja.html#regresja-prosta"><i class="fa fa-check"></i><b>5.1</b> Regresja prosta</a></li>
<li class="chapter" data-level="5.2" data-path="regresja.html"><a href="regresja.html#trend-liniowy"><i class="fa fa-check"></i><b>5.2</b> Trend liniowy</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sezonowosc.html"><a href="sezonowosc.html"><i class="fa fa-check"></i><b>6</b> Sezonowość</a><ul>
<li class="chapter" data-level="6.1" data-path="sezonowosc.html"><a href="sezonowosc.html#trend-liniowy-1"><i class="fa fa-check"></i><b>6.1</b> Trend liniowy</a></li>
<li class="chapter" data-level="6.2" data-path="sezonowosc.html"><a href="sezonowosc.html#model-addytywny"><i class="fa fa-check"></i><b>6.2</b> Model addytywny</a></li>
<li class="chapter" data-level="6.3" data-path="sezonowosc.html"><a href="sezonowosc.html#model-multiplikatywny"><i class="fa fa-check"></i><b>6.3</b> Model multiplikatywny</a></li>
<li class="chapter" data-level="6.4" data-path="sezonowosc.html"><a href="sezonowosc.html#ocena-jakosci"><i class="fa fa-check"></i><b>6.4</b> Ocena jakości</a></li>
<li class="chapter" data-level="6.5" data-path="sezonowosc.html"><a href="sezonowosc.html#bad-prognozy"><i class="fa fa-check"></i><b>6.5</b> Błąd prognozy</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html"><i class="fa fa-check"></i><b>7</b> Analiza szeregu dynamicznego</a><ul>
<li class="chapter" data-level="7.1" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#przyrosty-absolutne"><i class="fa fa-check"></i><b>7.1</b> Przyrosty absolutne</a></li>
<li class="chapter" data-level="7.2" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#przyrosty-wzgledne"><i class="fa fa-check"></i><b>7.2</b> Przyrosty względne</a></li>
<li class="chapter" data-level="7.3" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#indeksy"><i class="fa fa-check"></i><b>7.3</b> Indeksy</a></li>
<li class="chapter" data-level="7.4" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#srednie-tempo-zmian"><i class="fa fa-check"></i><b>7.4</b> Średnie tempo zmian</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html"><i class="fa fa-check"></i><b>8</b> Indeksy indywidualne i zespołowe</a><ul>
<li class="chapter" data-level="8.1" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html#indeksy-indywidualne"><i class="fa fa-check"></i><b>8.1</b> Indeksy indywidualne</a></li>
<li class="chapter" data-level="8.2" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html#indeksy-zespoowe-agregatowe"><i class="fa fa-check"></i><b>8.2</b> Indeksy zespołowe (agregatowe)</a></li>
<li class="chapter" data-level="8.3" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html#przykad"><i class="fa fa-check"></i><b>8.3</b> Przykład</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statystyka opisowa</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regresja" class="section level1">
<h1><span class="header-section-number">5</span> Regresja</h1>
<p>Metoda regresji wykorzystywana jest do funkcyjnego odwzorowania zależności pomiędzy badanymi zmiennymi. Jej celem jest poszukanie określonej klasy funkcji, która w możliwie najlepszy sposób charakteryzowałaby zależność pomiędzy zmiennymi. Funkcję tą określa się mianem funkcji regresji. Budując model chcemy osiągnąć określone cele poznawcze.</p>
<div id="regresja-prosta" class="section level2">
<h2><span class="header-section-number">5.1</span> Regresja prosta</h2>
<p>Celem regresji jest określenie, na podstawie dostępnych informacji, nieznanej wartości analizowanej cechy. Znamy wartości sprzedaży oraz liczby klientów w danym sklepie Rossmann i chcielibyśmy wyznaczyć możliwy poziom sprzedaży przy danej liczbie klientów np. 1000 klientów.</p>
<p>Podobnie jak w analizie korelacji punktem wyjścia w regresji prostej jest utworzenie wykresu rozrzutu. Ażeby móc zastosować model regresji musi występować związek korelacyjny pomiędzy zmiennymi oraz musi to być związek liniowy. Następnie na podstawie kryteriów merytorycznych określamy zmienną objaśnianą (<span class="math inline">\(y\)</span>) oraz zmienną objaśniającą (<span class="math inline">\(x\)</span>).</p>
<p>W analizowanym przez nas przypadku zmienną objaśnianą będzie poziom sprzedaży (<span class="math inline">\(y\)</span>), który będziemy wyjaśniać liczbą klientów (<span class="math inline">\(x\)</span>). Naszym celem jest znalezienie wzoru prostej, która będzie przebiegać możliwie najbliżej wszystkich punktów wykresu. W tym celu stosuje się Klasyczną Metodę Najmniejszych Kwadratów (KMNK).</p>
<p>Ogólna postać prostej regresji jest następująca:</p>
<p><span class="math display">\[\hat{y}_{i}=a_{1}x_{i}+a_{0}\]</span></p>
<p>gdzie <span class="math inline">\(y\)</span> z daszkiem (<span class="math inline">\(\hat{y}\)</span>) oznacza wartość teoretyczną, leżącą na wyznaczonej prostej.</p>
<p>Wobec tego wartości empiryczne (y) będą opisane formułą:</p>
<p><span class="math display">\[y_{i}=a_{1}x_{i}+a_{0}+u_{i}\]</span></p>
<p>w której <span class="math inline">\(u_i\)</span> oznacza składnik resztowy wyliczany jako <span class="math inline">\(u_{i}=y_{i}-\hat{y}_{i}\)</span>.</p>
<p>Musimy wyznaczyć współczynnik kierunkowy tej prostej (<span class="math inline">\(a_1\)</span>) oraz punkt przecięcia z osią OY (<span class="math inline">\(a_0\)</span>) określany mianem wyrazu wolnego.</p>
<p><img src="KS-Statystyka_opisowa_files/figure-html/ross-reg-1.png" width="768" /></p>
<p>Wartości tych współczynników możemy policzyć z wykorzystaniem następujących wzorów:</p>
<p><span class="math display">\[
a_{1}=\frac{\sum\limits_{i=1}^{n}{(x_{i}-\bar{x})(y_{i}-\bar{y})}}{\sum\limits_{i=1}^{n}{(x_{i}-\bar{x})^{2}}}
\]</span></p>
<p>lub znając wartość współczynnika korelacji liniowej Pearsona:</p>
<p><span class="math display">\[a_{1}=r\frac{S_{y}}{S_{x}}\]</span></p>
<p>z kolei wartość wyrazu wolnego można uzyskać ze wzoru:</p>
<p><span class="math display">\[a_{0}=\bar{y}-a_{1}\bar{x}\]</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\(r\)</span> — współczynnik korelacji liniowej Pearsona pomiędzy cechą <span class="math inline">\(x\)</span> i <span class="math inline">\(y\)</span>,</li>
<li><span class="math inline">\(S_y\)</span> — odchylenie standardowe dla cechy <span class="math inline">\(y\)</span>,</li>
<li><span class="math inline">\(S_x\)</span> — odchylenie standardowe dla cechy <span class="math inline">\(x\)</span>,</li>
<li><span class="math inline">\(\bar{y}\)</span> — średnia dla cechy <span class="math inline">\(y\)</span>,</li>
<li><span class="math inline">\(\bar{x}\)</span> — średnia dla cechy <span class="math inline">\(x\)</span>.</li>
</ul>
<p>Na tej podstawie ustalamy, że interesująca nas prosta ma następujący wzór:</p>
<p><span class="math display">\[\hat{y}_i=10,45x_i-1091,22\]</span></p>
<p>Współczynnik kierunkowy (<span class="math inline">\(a_1\)</span>) informuje o ile przeciętne zmieni się wartość zmiennej objaśnianej (y), gdy wartość zmiennej objaśniającej (x) wzrośnie o jednostkę. W naszym przypadku wzrost liczby klientów o 1 osobę spowoduje średni wzrost sprzedaży o 10,45 euro.</p>
<p>Z kolei wyraz wolny (<span class="math inline">\(a_0\)</span>) to wartość zmiennej objaśnianej (y), w sytuacji w której wartość zmiennej objaśniającej (x) będzie równa 0. Należy zachować szczególną ostrożność przy interpretacji tego współczynnika, ponieważ często jest on pozbawiony sensu. W analizowanym przykładzie współczynnik <span class="math inline">\(a_0\)</span> informuje, że przy zerowej liczbie klientów sprzedaż w sklepie nr 1 wyniesie -1091,22 euro.</p>
<p>Kolejnym elementem analizy regresji jest ocena dopasowania modelu. W tym celu posługujemy się kilkoma miarami.</p>
<p>Pierwszą miarą, która opisuje dopasowanie funkcji regresji do danych empirycznych jest <strong>odchylenie standardowe składnika resztowego</strong>, które jest pierwiastkiem z sumy kwadratów reszt podzielonej przez liczbę obserwacji pomniejszoną o 2. To pomniejszenie mianownika wynika z faktu, że w modelu mamy dwa współczynniki <span class="math inline">\(a_1\)</span> i <span class="math inline">\(a_0\)</span>, które w ten sposób uwzględniamy. Formalnie można to zapisać w następujący sposób:</p>
<p><span class="math display">\[S_{u}=\sqrt{\frac{\sum\limits_{i=1}^{n}{(y_{i}-\hat{y}_{i})^2}}{n-2}}\]</span></p>
<p>lub</p>
<p><span class="math display">\[S_{u}=\sqrt{\frac{\sum\limits_{i=1}^{n}{u_i^2}}{n-2}}\]</span></p>
<p>Miara ta określa, o ile, przeciętnie biorąc (<span class="math inline">\(+/-\)</span>), wartości empiryczne zmiennej objaśnianej odchylają się od wartości teoretycznych tej zmiennej, obliczonej na podstawie funkcji regresji. W analizowanym przypadku możemy stwierdzić, że znane wartości sprzedaży odchylają się od wartości teoretycznych średnio o <span class="math inline">\(+/-\)</span> 351,57 euro.</p>
<p>Odchylenie standardowe składnika resztowego jest także miarą błędu prognozy. Przykładowo, chcemy sprawdzić jak będzie kształtować się sprzedaż przy liczbie klientów równej 1000 osób. Po podstawieniu tej wartości do funkcji regresji otrzymamy:</p>
<p><span class="math display">\[y_{1000}=10,45 \cdot 1000 - 1091,22=9358,78\]</span></p>
<p>Na tej podstawie stwierdzamy, że przy 1000 klientów prognozowana sprzedaż wyniosłaby 9358,78 euro <span class="math inline">\(+/-\)</span> 351,57 euro.</p>
<p>Kolejna miara to <strong>współczynnik zmienności resztowej</strong>, który otrzymujemy poprzez podzielenie odchylenia standardowego składnika resztowego przez średni poziom cechy:</p>
<p><span class="math display">\[V_{u}=\frac{S_{u}}{\bar{y}}\cdot 100\%\]</span></p>
<p>Współczynnik ten wskazuje, jaki procent średniego poziomu zmiennej objaśnianej stanowią wahania losowe, których miarą jest <span class="math inline">\(S_{u}\)</span>. Parametr <span class="math inline">\(V_{u}\)</span> jest więc miernikiem relatywnej wielkości błędu losowego. Niektórzy autorzy postulują, że błąd ten można umownie uznać za dopuszczalny, jeśli <span class="math inline">\(V_{u}&lt;15\%\)</span>. Należy się jednak wystrzegać przed ,,dogmatycznym’’ podejściem do oceny modeli regresji i jedynie słusznych progów.</p>
<p>W naszym przypadku ten współczynnik będzie równy <span class="math inline">\(V_{u}=\frac{351,57}{4730,72}\cdot 100\%=7\%\)</span> co oznacza, że 7% średniego poziomu sprzedaży stanowią wahania losowe.</p>
<p>Równie ważną miarą dopasowania funkcji regresji do danych empirycznych jest <strong>współczynnik determinacji</strong> lub bardziej potocznie <strong>współczynnik r kwadrat</strong> — od symbolu, którym jest oznaczany. Współczynnik ten obliczany jest na podstawie reszt z modelu oraz odchyleń wartości empirycznych od średniej:</p>
<p><span class="math display">\[R^2=1-\frac{\sum\limits_{i=1}^{n}{(y_{i}-\hat{y}_{i})^2}}{\sum\limits_{i=1}^{n}{(y_{i}-\bar{y}_{i})^2}}\]</span></p>
<p>lub jako kwadrat współczynnika korelacji liniowej Pearsona:</p>
<p><span class="math display">\[R^2=r_{xy}^2\]</span></p>
<p>Określa, jaki procent wariancji zmiennej objaśnianej został wyjaśniony przez funkcję regresji. <span class="math inline">\(R^2\)</span> przyjmuje wartości z przedziału <span class="math inline">\(&lt;0;1&gt;\)</span> (<span class="math inline">\(&lt;0\%;100\%&gt;\)</span>), przy czym model regresji tym lepiej opisuje zachowanie się badanej zmiennej objaśnianej, im <span class="math inline">\(R^2\)</span> jest bliższy jedności (bliższy 100%)</p>
<p>Analizowany przez nas model regresji jest bardzo dobry: <span class="math inline">\(R^2=0,89\)</span>, co oznacza, że oszacowany model regresji wyjaśnia 89% zmienności sprzedaży.</p>
<p>Przeciwieństwem współczynnik determinacji <span class="math inline">\(R^2\)</span> jest <strong>współczynnik zbieżności (indeterminacji)</strong>. Tę miarę można wyznaczyć korzystając ze wzoru:</p>
<p><span class="math display">\[\varphi^2=\frac{\sum\limits_{i=1}^{n}{(y_{i}-\hat{y}_{i})^2}}{\sum\limits_{i=1}^{n}{(y_{i}-\bar{y}_{i})^2}}\]</span></p>
<p>bądź odejmując od wartości 1 wartość współczynnika <span class="math inline">\(R^2\)</span>:</p>
<p><span class="math display">\[\varphi^2=1-R^2\]</span></p>
<p>Współczynnik zbieżności <span class="math inline">\(\varphi^2\)</span> określa, jaka część wariancji badanej zmiennej objaśnianej nie została wyjaśniona przez funkcję regresji. Oczywiste jest więc, że korzystna sytuacja występuje wówczas, gdy <span class="math inline">\(\varphi^2\)</span> jest bliższy zera.</p>
<p>W przyjętym przez nas modelu regresji <span class="math inline">\(\phi^2=11\%\)</span>, co oznacza, że 11% zmienności sprzedaży nie została wyjaśniona przez funkcję regresji. Można także powiedzieć, że 11% zmienności sprzedaży stanowią czynniki losowe nie wyjaśniane przez funkcję regresji.</p>
<p>Ostatnim elementem analizy jest ocena jakości parametrów funkcji regresji <span class="math inline">\(a_1\)</span> i <span class="math inline">\(a_0\)</span>. Równanie regresji wyznaczyliśmy na podstawie dostępnych danych, ale nie znamy równania tej prostej w populacji. W związku z czym mogliśmy się trochę pomylić przy obliczaniu współczynników <span class="math inline">\(a_1\)</span> i <span class="math inline">\(a_0\)</span>. W celu oceny skali tych błędów wyznacza się <strong>błędy średnie szacunku ocen parametrów funkcji regresji</strong> według wzorów:</p>
<p><span class="math display">\[S_{a_{1}}=\frac{S_{u}}{\sqrt{\sum\limits_{i=1}^{n}{(x_{i}-\bar{x})^2}}}\]</span></p>
<p>oraz</p>
<p><span class="math display">\[S_{a_{0}}=\sqrt{\frac{S_{u}^{2}\sum\limits_{i=1}^{n}{{x_{i}^2}}}{n\sum\limits_{i=1}^{n}{(x_{i}-\bar{x})^2}}}\]</span></p>
<p>Błędy te wskazują, o ile, przeciętnie biorąc (<span class="math inline">\(+/-\)</span>), odchylają się oceny parametrów modelu regresji od ich wartości prawdziwych. Jest oczywiście pożądane, żeby te błędy były możliwie jak najmniejsze. W związku z powyższym przyjmuje się, że ilorazy:</p>
<p><span class="math display">\[V_{a_{1}}=\frac{S_{a_{1}}}{a_{1}}\]</span></p>
<p><span class="math display">\[V_{a_{0}}=\frac{S_{a_{0}}}{a_{0}}\]</span></p>
<p>nie powinny przekraczać wartości 0,5 (50%) w wartości bezwzględnej.</p>
<p>Jest to szczególnie istotne w przypadku parametru współczynnika kierunkowego <span class="math inline">\(a_1\)</span>, natomiast dla wyrazu wolnego <span class="math inline">\(a_0\)</span> ta własność nie musi być spełniona.</p>
<p>W analizowanym przez nas modelu wartość parametru <span class="math inline">\(a_1\)</span> odchyla się od jego wartości prawdziwej o <span class="math inline">\(+/-\)</span> 0,21 co stanowi 2% wartości tego parametru. Z kolei wartość parametru <span class="math inline">\(a_0\)</span> odchyla się od jego wartości prawdziwej o <span class="math inline">\(+/-\)</span> 119,81 co stanowi 11% wartości tego parametru.</p>
<p><strong>Regresja prosta w Excelu</strong></p>
<ul>
<li><strong>Sposób nr 1</strong></li>
</ul>
<p>Parametry funkcji regresji można także wyznaczyć korzystając z wbudowanej funkcji programu Excel — REGLINP. Składnia jest następująca:</p>
<ul>
<li>REGLINP(wektor_y; wektor_x; stała; statystyka)</li>
</ul>
<p>gdzie:</p>
<ul>
<li>wektor_y — zestaw wartości zmiennej objaśnianej (y),</li>
<li>wektor_x — zestaw wartości zmiennej objaśniającej (y),</li>
<li>stała — jeśli podamy wartość 1 to wyraz wolny jest obliczany normalnie, jeśli podamy 0 to zostanie oszacowany model bez wyrazu wolnego,</li>
<li>statystyka — jeśli argument ma wartość 1 to funkcja REGLINP zwraca dodatkowe statystyki regresji, natomiast jeśli ma wartość 0 to funkcja zwraca tylko wartości współczynnika kierunkowego oraz wyrazu wolnego.</li>
</ul>
<p>Po napisaniu funkcji i uwzględnieniu wszystkich argumentów naciskamy ENTER — powinna pojawić się jedna wartość. Następnie należy zaznaczyć obszar 2 kolumny na 5 wiersze uwzględniając w lewej górnej komórce otrzymaną wcześniej wartość. W kolejnym kroku przechodzimy do PASKU FORMUŁY programu Excel i korzystamy z tajemnej formuły CTRL+SHIFT+ENTER.</p>
<p>W rezultacie otrzymujemy tabelę o wymiarach 2x5, która zawiera następujące elementy:</p>
<table style="width:100%;">
<colgroup>
<col width="50%" />
<col width="49%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Współczynnik kierunkowy (<span class="math inline">\(a_{1}\)</span>)</td>
<td>Wyraz wolny (<span class="math inline">\(a_{0}\)</span>)</td>
</tr>
<tr class="even">
<td>Średni błąd szacunku parametru (<span class="math inline">\(S_{a_{1}}\)</span>)</td>
<td>Średni błąd szacunku parametru (<span class="math inline">\(S_{a_{0}}\)</span>)</td>
</tr>
<tr class="odd">
<td>Współczynnik determinacji (<span class="math inline">\(R^2\)</span>)</td>
<td>Odchylenie standardowe składnika resztowego (<span class="math inline">\(S_{u}\)</span>)</td>
</tr>
<tr class="even">
<td>Statystyka F (<span class="math inline">\(F\)</span>)</td>
<td>Liczba stopni swobody (<span class="math inline">\(n-2\)</span>)</td>
</tr>
<tr class="odd">
<td>Regresyjna suma kwadratów (<span class="math inline">\(\sum{(\hat{y}-\bar{y})^2}\)</span>)</td>
<td>Suma kwadratów reszt (<span class="math inline">\(\sum{(y-\hat{y})^2}\)</span>)</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Sposób nr 2</strong></li>
</ul>
<p>Zaznaczamy punkty na wykresie rozrzutu i klikamy prawym przyciskiem myszy. Wybieramy <strong>Dodaj linię trendu</strong>, a następnie zaznaczamy opcje Wyświetl równanie na wykresie oraz Wyświetl wartości R-kwadrat na wykresie.</p>
<ul>
<li><strong>Sposób nr 3</strong></li>
</ul>
<p>Do wyznaczenia parametrów regresji można także wykorzystać graficzne środowisko analizy danych. W tych celu wybieramy zakładkę DANE i po prawej stronie ANALIZA DANYCH. W menu zaznaczamy REGRESJA i klikamy OK. W opcjach wejścia zaznaczamy:</p>
<ul>
<li>Zakres wejściowy Y — zestaw wartości zmiennej objaśnianej (y),</li>
<li>Zakres wejściowy X — zestaw wartości zmiennej objaśniającej (x),</li>
<li>Tytuły — jeśli zostały zaznaczone kolumny wraz z nagłówkami.</li>
</ul>
<p>W opcjach wyjścia określamy miejsce wyświetlenia wyniku: bieżący arkusz/nowy arkusz/nowy skoroszyt.</p>
<p>W rezultacie otrzymujemy następujący wynik:</p>
<p>PODSUMOWANIE - WYJŚCIE</p>
<table>
<thead>
<tr class="header">
<th>Statystyki regresji</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Wielokrotność R</td>
<td><span class="math inline">\(r\)</span></td>
</tr>
<tr class="even">
<td>R kwadrat</td>
<td><span class="math inline">\(R^2\)</span></td>
</tr>
<tr class="odd">
<td>Dopasowany R kwadrat</td>
<td></td>
</tr>
<tr class="even">
<td>Błąd standardowy</td>
<td><span class="math inline">\(S_{u}\)</span></td>
</tr>
<tr class="odd">
<td>Obserwacje</td>
<td><span class="math inline">\(n\)</span></td>
</tr>
</tbody>
</table>
<p>ANALIZA WARIANCJI</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>df</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
<th>Istotność F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regresja</td>
<td>1</td>
<td><span class="math inline">\(\sum{(\hat{y}-\bar{y})^2}\)</span></td>
<td></td>
<td><span class="math inline">\(F\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Resztkowy</td>
<td><span class="math inline">\(n-2\)</span></td>
<td><span class="math inline">\(\sum{(y-\hat{y})^2}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Razem</td>
<td><span class="math inline">\(n-1\)</span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th></th>
<th>Współczynniki</th>
<th>Błąd standardowy</th>
<th>t Stat</th>
<th>Wartość-p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Przecięcie</td>
<td><span class="math inline">\(a_{0}\)</span></td>
<td><span class="math inline">\(S_{a_{0}}\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>zmienna x</td>
<td><span class="math inline">\(a_{1}\)</span></td>
<td><span class="math inline">\(S_{a_{1}}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Zależności:</p>
<ul>
<li><p>Jeżeli ze wzoru na odchylenie standardowe składnika resztowego usuniemy pierwiastek to otrzymamy wariancję składnika resztowego, którą należy najpierw spierwiastkować, aby móc przeprowadzić interpretację.</p></li>
<li><p>Jeśli bardzo chcemy policzyć wartość odchylenia standardowe składnika resztowego na podstawie wartości surowych to wartość licznika możemy odczytać z funkcji REGLINP — 5 wiersz, 2 kolumna. Wówczas wystarczy podzielić tę wartość przez 4 wiersz drugiej kolumny i spierwiastkować, aby otrzymać wartość <span class="math inline">\(S_u\)</span>. Podobnie postępujemy, jeśli korzystamy z narzędzia REGRESJA.</p></li>
</ul>
<p><em>Zadania</em></p>
<p>Ilu klientów powinno przyjść do sklepu nr 7, żeby możliwe było osiągnięcie sprzedaży na poziomie 20000 euro? Zapisz uzyskany model, zinterpretuj parametry regresji oraz oceń jakość dopasowania.</p>
</div>
<div id="trend-liniowy" class="section level2">
<h2><span class="header-section-number">5.2</span> Trend liniowy</h2>
<p>Oprócz określania nieznanych wartości cechy, regresja jest także wykorzystywana do prognozowania w czasie. Przykładowo mając dane dotyczące miesięcznej sprzedaży w roku 2014 spróbujemy określić możliwą sprzedaż w wybranym miesiącu 2015 roku.</p>
<p>Sposób postępowania jest bardzo podobny do regresji prostej z tym, że zamiast wartości cechy <span class="math inline">\(x\)</span> mamy kolejne numery okresów <span class="math inline">\(t=1,2,3,..., n\)</span>. Wówczas równanie trendu ma następującą postać:</p>
<p><span class="math display">\[\hat{y}_{i}=a_{1}t_{i}+a_{0}\]</span></p>
<p>Po oszacowaniu parametrów <span class="math inline">\(a_1\)</span> i <span class="math inline">\(a_0\)</span> nieco inaczej je zinterpretujemy. Wartość parametru <span class="math inline">\(a_1\)</span> informuje o średniej zmianie cechy <span class="math inline">\(y\)</span> z okresu na okres, z kolei <span class="math inline">\(a_0\)</span> to wartość wynikająca z modelu dla okresu poprzedzającego analizę.</p>
<p>Spróbujmy określić możliwą sprzedaż w styczniu 2015 roku dla sklepu nr 7. W tym zagregowaliśmy dane do postaci miesięcznej. Model regresji ma następującą postać:</p>
<p><span class="math display">\[\hat{y}_{i}=4850t_{i}+196592\]</span></p>
<p>Wynika z niego, że z miesiąca na miesiąc sprzedaż rosła średnio o 4850 euro. Natomiast możliwa sprzedaż w grudniu 2013 roku wynosiła 196592 euro.</p>
<p>Ocena jakości modelu przebiega analogicznie jak w przypadku regresji prostej. Inaczej wyznacza się błąd prognozy, co wynika z faktu, że im bardziej “oddalimy” się od okresu na podstawie którego oszacowaliśmy parametry trendu, tym błąd prognozy będzie większy.</p>
<p>Przy obliczaniu błędu prognozy korzystamy ze wzoru:</p>
<p><span class="math display">\[D(y_{T}^{P})=S_u\sqrt{1+\frac{1}{n}+\frac{(T-\bar{t})^2}{\sum\limits_{t=1}^{n}{(t_i-\bar{t})^2}}}\]</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\(S_u\)</span> — odchylenie standardowe składnika resztowego,</li>
<li><span class="math inline">\(n\)</span> — liczba znanych okresów,</li>
<li><span class="math inline">\(\bar{t}\)</span> — średnia z numerów okresów,</li>
<li><span class="math inline">\(T\)</span> — numer okresu, na który stawiana jest prognoza.</li>
</ul>
<p>Odchylenie standardowe składnika resztowego wynosiło 20031 euro, co oznacza, że znane wartości miesięcznej sprzedaży odchylają się od wartości wynikających z trendu średnio o <span class="math inline">\(+/-\)</span> 20031 euro.</p>
<p>Wyznaczając błąd prognozy musimy uwzględnić dodatkowy składnik uwzględniający czas. W związku z tym prognozowana sprzedaż w styczniu 2015 roku wyniesie:</p>
<p><span class="math display">\[\hat{y}_{13}=4850\cdot13+196592=259639\]</span></p>
<p>a błąd prognozy:</p>
<p><span class="math display">\[D(y_{13}^{P})=20031\sqrt{1+\frac{1}{12}+\frac{(13-6,5)^2}{143}}=23521\]</span></p>
<p>Czyli prognozowana miesiączna sprzedaż w styczniu 2015 roku wyniesie 259 639 euro +/- 23 521 euro.</p>
<p>Natomiast dla lutego wartość błędu prognozy będzie już większa:</p>
<p><span class="math display">\[\hat{y}_{14}=4850\cdot14+196592=264489\]</span></p>
<p><span class="math display">\[D(y_{14}^{P})=20031\sqrt{1+\frac{1}{12}+\frac{(14-6,5)^2}{143}}=24341\]</span></p>
<p><em>Zadania</em></p>
<p>Ile wynosi prognozowana miesięczna sprzedaż (oraz błąd prognozy) w sklepie nr 5 w kwietniu 2015 roku.</p>
<p><strong>Zadanie egzaminacyjne</strong></p>
<p>Postanowiono zbadać zależność pomiędzy dzienną liczbą klientów (w tys. osób) a dziennym przychodem (w tys. zł) w pewnej sieci sklepów. W tym celu wybrano 16 sklepów (po jednym z każdego województwa), w których badano te wielkości. Analiza wykazała, że średnia liczba klientów wynosiła 1,5 tys. osób, a dziennego przychodu 40 tys. zł. Współczynnik zmienności dla liczby klientów był równy 13%, a dla przychodu 17%. Suma kwadratów reszt wynosiła 70, a współczynnik korelacji liniowej Pearsona 0,89.</p>
<ol style="list-style-type: lower-alpha">
<li>Wyznacz parametry funkcji regresji i zapisz jej postać.</li>
<li>Oceń jakość otrzymanej funkcji.</li>
<li>Ile wynosi prognozowany dzienny przychód (oraz błąd prognozy) dla sklepu obsługującego dziennie 800 osób?</li>
</ol>
<p><strong>Rozwiązanie</strong></p>
<p>Dane:</p>
<ul>
<li><span class="math inline">\(\bar{x}=1,5\)</span></li>
<li><span class="math inline">\(\bar{y}=40\)</span></li>
<li><span class="math inline">\(V_x=0,13\)</span></li>
<li><span class="math inline">\(V_y=0,17\)</span></li>
<li><span class="math inline">\(\sum{(y-\hat{y})^2}=70\)</span></li>
<li><span class="math inline">\(n=16\)</span></li>
<li><span class="math inline">\(r=0,89\)</span></li>
</ul>
<p>Na podstawie powyższych danych wyznaczamy <span class="math inline">\(S_x=V_x\cdot \bar{x}=0,13\cdot 1,5=0,195\)</span> oraz <span class="math inline">\(S_y=V_y\cdot \bar{y}=0,17\cdot 40=6,8\)</span>. Następnie <span class="math inline">\(S_u=\sqrt{\frac{\sum{(y-\hat{y})^2}}{n-2}}=\sqrt{\frac{70}{16-2}}=2,24\)</span>.</p>
<p>Na podstawie odpowiednich wzorów wyznaczamy parametry regresji: <span class="math inline">\(a_1=r\cdot\frac{S_y}{S_x}=0,89\cdot \frac{6,8}{0,195}=31,04\)</span> oraz <span class="math inline">\(a_0=\bar{y}-a_1\cdot\bar{x}=40-31,04\cdot1,5=-6,55\)</span>. W związku z tym funkcja regresji ma następującą postać:</p>
<p><span class="math display">\[\hat{y}=31,04\cdot x - 6,55\]</span></p>
<p>Jakość modelu oceniamy na podstawie wartości <span class="math inline">\(S_u\)</span> oraz <span class="math inline">\(R^2=r^2=0,89^2=0,79\)</span>.</p>
<p>Dzienny przychód dla sklepu obsługującego dziennie 800 osób będzie wynosił <span class="math inline">\(\hat{y}(0,8)=31,04 \cdot 0,8 -6,55=18,27\)</span> tys. zł <span class="math inline">\(+/- 2,24\)</span> tys. zł.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="korelacje.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sezonowosc.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["KS-Statystyka_opisowa.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
