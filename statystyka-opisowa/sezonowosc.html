<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Sezonowość | Statystyka opisowa</title>
  <meta name="description" content="6 Sezonowość | Statystyka opisowa" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Sezonowość | Statystyka opisowa" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Sezonowość | Statystyka opisowa" />
  
  
  

<meta name="author" content="Katedra Statystyki" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regresja.html"/>
<link rel="next" href="analiza-szeregu-dynamicznego.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Wprowadzenie</a></li>
<li class="chapter" data-level="1" data-path="zbiorowosc.html"><a href="zbiorowosc.html"><i class="fa fa-check"></i><b>1</b> Zbiorowość, jednostka, cecha</a><ul>
<li class="chapter" data-level="1.1" data-path="zbiorowosc.html"><a href="zbiorowosc.html#zbiory-danych"><i class="fa fa-check"></i><b>1.1</b> Zbiory danych</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html"><i class="fa fa-check"></i><b>2</b> Wizualizacja danych</a><ul>
<li class="chapter" data-level="2.1" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#rodzaje-rozkadow"><i class="fa fa-check"></i><b>2.1</b> Rodzaje rozkładów</a></li>
<li class="chapter" data-level="2.2" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#szeregi-statystyczne"><i class="fa fa-check"></i><b>2.2</b> Szeregi statystyczne</a></li>
<li class="chapter" data-level="2.3" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#dystrybuanta"><i class="fa fa-check"></i><b>2.3</b> Dystrybuanta</a></li>
<li class="chapter" data-level="2.4" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#histogramy"><i class="fa fa-check"></i><b>2.4</b> Histogramy</a><ul>
<li class="chapter" data-level="2.4.1" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-arbitralnie-ustalanej-szerokosci-przedziaow"><i class="fa fa-check"></i><b>2.4.1</b> Metoda arbitralnie ustalanej szerokosci przedziałów</a></li>
<li class="chapter" data-level="2.4.2" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-pierwiastkowa"><i class="fa fa-check"></i><b>2.4.2</b> Metoda pierwiastkowa</a></li>
<li class="chapter" data-level="2.4.3" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-strugesa"><i class="fa fa-check"></i><b>2.4.3</b> Metoda Struges’a</a></li>
<li class="chapter" data-level="2.4.4" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-uniwersytetu-rice"><i class="fa fa-check"></i><b>2.4.4</b> Metoda Uniwersytetu Rice</a></li>
<li class="chapter" data-level="2.4.5" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-doanea"><i class="fa fa-check"></i><b>2.4.5</b> Metoda Doane’a</a></li>
<li class="chapter" data-level="2.4.6" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-scotta"><i class="fa fa-check"></i><b>2.4.6</b> Metoda Scott’a</a></li>
<li class="chapter" data-level="2.4.7" data-path="wizualizacja-danych.html"><a href="wizualizacja-danych.html#metoda-freedmanadiaconisa"><i class="fa fa-check"></i><b>2.4.7</b> Metoda Freedmana–Diaconis’a</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analiza-struktury.html"><a href="analiza-struktury.html"><i class="fa fa-check"></i><b>3</b> Analiza struktury</a><ul>
<li class="chapter" data-level="3.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-klasyczne"><i class="fa fa-check"></i><b>3.1</b> Miary klasyczne</a></li>
<li class="chapter" data-level="3.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-pozycyjne"><i class="fa fa-check"></i><b>3.2</b> Miary pozycyjne</a></li>
<li class="chapter" data-level="3.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#szereg-jednostkowy-i-przedziaowy"><i class="fa fa-check"></i><b>3.3</b> Szereg jednostkowy i przedziałowy</a><ul>
<li class="chapter" data-level="3.3.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#szereg-jednostkowy"><i class="fa fa-check"></i><b>3.3.1</b> Szereg jednostkowy</a></li>
<li class="chapter" data-level="3.3.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#szereg-przedziaowy"><i class="fa fa-check"></i><b>3.3.2</b> Szereg przedziałowy</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="analiza-struktury.html"><a href="analiza-struktury.html#podsumowanie-miar"><i class="fa fa-check"></i><b>3.4</b> Podsumowanie miar</a><ul>
<li class="chapter" data-level="3.4.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#schemat"><i class="fa fa-check"></i><b>3.4.1</b> Schemat</a></li>
<li class="chapter" data-level="3.4.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-klasyczne-1"><i class="fa fa-check"></i><b>3.4.2</b> Miary klasyczne</a></li>
<li class="chapter" data-level="3.4.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#miary-pozycyjne-1"><i class="fa fa-check"></i><b>3.4.3</b> Miary pozycyjne</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="analiza-struktury.html"><a href="analiza-struktury.html#przedziay-ufnosci"><i class="fa fa-check"></i><b>3.5</b> Przedziały ufności</a><ul>
<li class="chapter" data-level="3.5.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#srednia-w-populacji-normalnej-ze-znanym-odchyleniem-standardowym"><i class="fa fa-check"></i><b>3.5.1</b> Średnia w populacji normalnej ze znanym odchyleniem standardowym</a></li>
<li class="chapter" data-level="3.5.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#srednia-w-populacji-normalnej-z-nieznanym-odchyleniem-standardowym---maa-proba"><i class="fa fa-check"></i><b>3.5.2</b> Średnia w populacji normalnej z nieznanym odchyleniem standardowym - mała próba</a></li>
<li class="chapter" data-level="3.5.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#srednia-w-populacji-normalnej-z-nieznanym-odchyleniem-standardowym---duza-proba"><i class="fa fa-check"></i><b>3.5.3</b> Średnia w populacji normalnej z nieznanym odchyleniem standardowym - duża próba</a></li>
<li class="chapter" data-level="3.5.4" data-path="analiza-struktury.html"><a href="analiza-struktury.html#proporcja"><i class="fa fa-check"></i><b>3.5.4</b> Proporcja</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="analiza-struktury.html"><a href="analiza-struktury.html#testy-statystyczne"><i class="fa fa-check"></i><b>3.6</b> Testy statystyczne</a><ul>
<li class="chapter" data-level="3.6.1" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-t-dla-jednej-sredniej"><i class="fa fa-check"></i><b>3.6.1</b> Test t dla jednej średniej</a></li>
<li class="chapter" data-level="3.6.2" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-istotnosci-proporcji"><i class="fa fa-check"></i><b>3.6.2</b> Test istotności proporcji</a></li>
<li class="chapter" data-level="3.6.3" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-t-dla-dwoch-srednich-niezaleznych"><i class="fa fa-check"></i><b>3.6.3</b> Test t dla dwóch średnich niezależnych</a></li>
<li class="chapter" data-level="3.6.4" data-path="analiza-struktury.html"><a href="analiza-struktury.html#test-istotnosci-dwoch-proporcji"><i class="fa fa-check"></i><b>3.6.4</b> Test istotności dwóch proporcji</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="korelacje.html"><a href="korelacje.html"><i class="fa fa-check"></i><b>4</b> Korelacje</a><ul>
<li class="chapter" data-level="4.1" data-path="korelacje.html"><a href="korelacje.html#cechy-jakosciowe"><i class="fa fa-check"></i><b>4.1</b> Cechy jakościowe</a></li>
<li class="chapter" data-level="4.2" data-path="korelacje.html"><a href="korelacje.html#cechy-ciage"><i class="fa fa-check"></i><b>4.2</b> Cechy ciągłe</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regresja.html"><a href="regresja.html"><i class="fa fa-check"></i><b>5</b> Regresja</a><ul>
<li class="chapter" data-level="5.1" data-path="regresja.html"><a href="regresja.html#regresja-prosta"><i class="fa fa-check"></i><b>5.1</b> Regresja prosta</a></li>
<li class="chapter" data-level="5.2" data-path="regresja.html"><a href="regresja.html#trend-liniowy"><i class="fa fa-check"></i><b>5.2</b> Trend liniowy</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sezonowosc.html"><a href="sezonowosc.html"><i class="fa fa-check"></i><b>6</b> Sezonowość</a><ul>
<li class="chapter" data-level="6.1" data-path="sezonowosc.html"><a href="sezonowosc.html#trend-liniowy-1"><i class="fa fa-check"></i><b>6.1</b> Trend liniowy</a></li>
<li class="chapter" data-level="6.2" data-path="sezonowosc.html"><a href="sezonowosc.html#model-addytywny"><i class="fa fa-check"></i><b>6.2</b> Model addytywny</a></li>
<li class="chapter" data-level="6.3" data-path="sezonowosc.html"><a href="sezonowosc.html#model-multiplikatywny"><i class="fa fa-check"></i><b>6.3</b> Model multiplikatywny</a></li>
<li class="chapter" data-level="6.4" data-path="sezonowosc.html"><a href="sezonowosc.html#ocena-jakosci"><i class="fa fa-check"></i><b>6.4</b> Ocena jakości</a></li>
<li class="chapter" data-level="6.5" data-path="sezonowosc.html"><a href="sezonowosc.html#bad-prognozy"><i class="fa fa-check"></i><b>6.5</b> Błąd prognozy</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html"><i class="fa fa-check"></i><b>7</b> Analiza szeregu dynamicznego</a><ul>
<li class="chapter" data-level="7.1" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#przyrosty-absolutne"><i class="fa fa-check"></i><b>7.1</b> Przyrosty absolutne</a></li>
<li class="chapter" data-level="7.2" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#przyrosty-wzgledne"><i class="fa fa-check"></i><b>7.2</b> Przyrosty względne</a></li>
<li class="chapter" data-level="7.3" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#indeksy"><i class="fa fa-check"></i><b>7.3</b> Indeksy</a></li>
<li class="chapter" data-level="7.4" data-path="analiza-szeregu-dynamicznego.html"><a href="analiza-szeregu-dynamicznego.html#srednie-tempo-zmian"><i class="fa fa-check"></i><b>7.4</b> Średnie tempo zmian</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html"><i class="fa fa-check"></i><b>8</b> Indeksy indywidualne i zespołowe</a><ul>
<li class="chapter" data-level="8.1" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html#indeksy-indywidualne"><i class="fa fa-check"></i><b>8.1</b> Indeksy indywidualne</a></li>
<li class="chapter" data-level="8.2" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html#indeksy-zespoowe-agregatowe"><i class="fa fa-check"></i><b>8.2</b> Indeksy zespołowe (agregatowe)</a></li>
<li class="chapter" data-level="8.3" data-path="indeksy-indywidualne-i-zespoowe.html"><a href="indeksy-indywidualne-i-zespoowe.html#przykad"><i class="fa fa-check"></i><b>8.3</b> Przykład</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statystyka opisowa</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sezonowosc" class="section level1">
<h1><span class="header-section-number">6</span> Sezonowość</h1>
<p>Jednym z rodzajów szeregu statystycznego jest szereg czasowy, który można zdefiniować jako ciąg obserwacji jakiegoś zjawiska w kolejnych jednostkach czasu (latach, kwartałach, miesiącach). Rozważane zjawisko może podlegać pewnym prawidłowościom, których wykrycie i opis jest celem analizy szeregów czasowych. Najczęściej rozważa się cztery czynniki wpływające na rozwój zjawiska w czasie:</p>
<ul>
<li>trend (<span class="math inline">\(T_t\)</span>) — długookresowe, systematyczne zmiany, jakim podlega dane zjawisko,</li>
<li>wahania sezonowe (<span class="math inline">\(S_t\)</span>) — regularne odchylenia od tendencji rozwojowej (trendu) związane np. z porami roku (warunkami klimatycznymi),</li>
<li>wahania cykliczne (<span class="math inline">\(C_t\)</span>) — związane z cyklem koniunkturalnym,</li>
<li>wahania przypadkowe (<span class="math inline">\(I_t\)</span>) — nieregularne zmiany.</li>
</ul>
<p>Analiza danych, które mogą charakteryzować się sezonowością rozpoczyna się od wizualizacji oraz estymacji parametrów modelu liniowego. W tym celu posłużymy się dwoma przykładami. Pierwszy będzie dotyczył zużycia energii elektrycznej, a drugi przewozów ładunków w Polsce - <a href="zbiory/sezonowosc.xlsx">plik</a>.</p>
<div class="figure">
<img src="img/przyklad1.png" alt="Zużycie energii - dane oryginalne" />
<p class="caption">Zużycie energii - dane oryginalne</p>
</div>
<div class="figure">
<img src="img/przyklad2.png" alt="Przewóz ładunków - dane oryginalne" />
<p class="caption">Przewóz ładunków - dane oryginalne</p>
</div>
<p>W obu przypadkach dysponujemy danymi kwartalnymi za lata 2003–2005. Na pierwszy rzut oka możemy wskazać pewne prawidłowości: zużycie energii jest widocznie wyższe w drugich i czwartych kwartałach analizowanych lat. Z kolei przewozy ładunków wzrastają od kwartału pierwszego do trzeciego (w którym osiągają maksimum w danym roku), by następnie spaść.</p>
<p>Celem analizy będzie ilościowe określenie wielkości zmian sezonowych, tak aby było możliwe prognozowanie z uwzględnieniem tych czynników.</p>
<div id="trend-liniowy-1" class="section level2">
<h2><span class="header-section-number">6.1</span> Trend liniowy</h2>
<p>Pierwszym krokiem w analizie szeregu czasowego jest estymacja parametrów trendu liniowego.</p>
<p>Dla przykładu pierwszego dotyczącego zużycia energii funkcja regresji przyjmuje następującą postać:</p>
<p><span class="math display">\[\hat{y}_{t}=0,15 \cdot t+2,99\]</span></p>
<p>w której współczynnik kierunkowy informuje o tym, że z kwartału na kwartał zużycie energii rosło przeciętnie o 0,15 MWh. Z kolei wyraz wolny równy 2,99 oznacza, że w okresie <span class="math inline">\(t=0\)</span> czyli w IV kwartale 2002 roku, teoretyczne zużycie energii wynosiło 2,99 MWh.</p>
<p>W drugim z analizowanych przykładów — przewozów ładunków — model wyglądał następująco:</p>
<p><span class="math display">\[\hat{y}_{t}=0,38 \cdot t+25,13\]</span></p>
<p>co oznacza, że z kwartału na kwartał przewóz ładunków wzrastał średnio o 0,38 mln ton, natomiast w IV kwartale 2002 roku modelowa wartość przewozów ładunków wynosiła 25,13 mln ton.</p>
<p>Na podstawie wyznaczonych funkcji regresji można obliczyć wartości teoretyczne (<span class="math inline">\(\hat{y}_t\)</span>) zużycia energii oraz przewozów ładunków i pod postacią prostej przestawić na wykresie.</p>
<p><img src="img/przyklad1_trend.png" alt="Zużycie energii - trend liniowy" />
<img src="img/przyklad2_trend.png" alt="Przewóz ładunków - trend ilniowy" /></p>
<p>Otrzymane wartości wynikające z funkcji trendu (<span class="math inline">\(\hat{y}_t\)</span>) mają charakter liniowy i prawdę rzecz ujmując słabo dopasowują się do danych empirycznych. Współczynnik <span class="math inline">\(R^2\)</span> w przykładzie pierwszym wynosi 41%, a w przykładzie drugim tylko 37%. Ponadto, jeśli chcielibyśmy prognozować na kolejne okresy to według funkcji trendu wartości zużycia energii dla kwartałów pierwszych byłyby przeszacowane, a dla kwartałów czwartych niedoszacowane. Stąd zachodzi potrzeba uwzględnienia w modelu występowania sezonowości, którą obserwujemy w danych.</p>
<p>Pierwszym krokiem jest identyfikacja rodzaju tej sezonowości. Może ona mieć charakter addytywny — wtedy wahania sezonowe są stałe w poszczególnych okresach (por. przykład 1) lub multiplikatywny, kiedy czynniki sezonowe są proporcjonalne do funkcji trendu (por. przykład 2). W zależności od zidentyfikowanego charakteru należy obliczyć wskaźniki sezonowości. W pierwszej kolejności rozważymy model addytywny.</p>
</div>
<div id="model-addytywny" class="section level2">
<h2><span class="header-section-number">6.2</span> Model addytywny</h2>
<p>Analizę modelu addytywnego należy rozpocząć od wyznaczenia różnic pomiędzy wartościami empirycznymi (<span class="math inline">\(y\)</span>) a modelowymi (<span class="math inline">\(\hat{y}\)</span>) dla poszczególnych okresów zgodnie ze wzorem:</p>
<p><span class="math display">\[S^i_t=y_t-\hat{y}_t\]</span></p>
<p>Następnie dla każdego z analizowanych podokresów (półroczy, kwartałów, miesięcy) oblicza się surowe wskaźniki sezonowości uśredniając wyznaczone wcześniej różnice:</p>
<p><span class="math display">\[S_i=\frac{\sum\limits_{i=1}^{m}{S_t^i}}{p}\]</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\(m\)</span> — liczba podokresów (półroczy, kwartałów, miesięcy),</li>
<li><span class="math inline">\(p\)</span> — liczba analizowanych lat.</li>
</ul>
<p>W analizowanym przez nas przykładzie musimy wyznaczyć surowe wskaźniki sezonowości dla każdego kwartału. Ponadto jeśli spełniona będzie zależność <span class="math inline">\(\sum\limits_{i=1}^{m}{S_i}=0\)</span> to oznacza, że wskaźniki sezonowości są wolne od wahań przypadkowych. W praktyce jednak rzadko zdarza się taka sytuacja. W takim przypadku należy jeszcze wyznaczyć współczynnik korygujący zgodnie z wzorem:</p>
<p><span class="math display">\[k=\frac{\sum\limits_{i=1}^{m}{S_i}}{m}\]</span></p>
<p>a następnie skorygować surowe wskaźniki sezonowości według formuły</p>
<p><span class="math display">\[So_{i}=S_i-k\]</span></p>
<p>otrzymując tzw. oczyszczone wskaźniki sezonowości, które informują o średnich odchyleniach od funkcji trendu w poszczególnych podokresach. Dla tych wskaźników zachodzi zależność: <span class="math inline">\(\sum\limits_{i=1}^{m}{So_{i}}=0\)</span>. W przykładzie 1 oczyszczone wskaźniki sezonowości dla poszczególnych kwartałów są równe:</p>
<table>
<colgroup>
<col width="7%" />
<col width="6%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th>Wskaźnik</th>
<th>Wartość</th>
<th>Interpretacja</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(So_{1}\)</span></td>
<td>-0,62</td>
<td>w pierwszych kwartałach lat 2003–2005 zużycie energii było mniejsze średnio o 0,62 MWh niż wynika to z funkcji trendu</td>
</tr>
<tr class="even">
<td><span class="math inline">\(So_{2}\)</span></td>
<td>0,33</td>
<td>w drugich kwartałach lat 2003–2005 zużycie energii było większe średnio o 0,33 MWh niż wynika to z funkcji trendu</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(So_{3}\)</span></td>
<td>-0,51</td>
<td>w trzecich kwartałach lat 2003–2005 zużycie energii było mniejsze średnio o 0,51 MWh niż wynika to z funkcji trendu</td>
</tr>
<tr class="even">
<td><span class="math inline">\(So_{4}\)</span></td>
<td>0,81</td>
<td>w czwartych kwartałach lat 2003–2005 zużycie energii było większe średnio o 0,81 MWh niż wynika to z funkcji trendu</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>0,00</td>
<td>wskaźniki sezonowości są wolne od wahań przypadkowych</td>
</tr>
</tbody>
</table>
<p>Kolejnym etapem analizy jest wyznaczenie zmodyfikowanych wartości teoretycznych uwzględniających sezonowość. Te wartości oznaczane jako <span class="math inline">\(\hat{y}^*\)</span> uzyskujemy dodając do wartości teoretycznych (<span class="math inline">\(\hat{y}\)</span>) odpowiednie dla poszczególnych podokresów oczyszczone wskaźniki sezonowości <span class="math inline">\(So_i\)</span>. Formalny zapis jest następujący:</p>
<p><span class="math display">\[\hat{y}^*=\hat{y}+So_i\]</span></p>
<p>Wartości <span class="math inline">\(\hat{y}^*\)</span> przedstawione na wykresie już znacznie lepiej pasują do posiadanych danych empirycznych:</p>
<div class="figure">
<img src="img/przyklad1_sezon.png" alt="Zużycie energii - trend z sezonowością" />
<p class="caption">Zużycie energii - trend z sezonowością</p>
</div>
<p>Na podstawie tak zmodyfikowanego modelu można prognozować przyszłe wartości z dużo większą precyzją. Prognozowanie w modelu addytywnym polega na podstawieniu numeru okresu dla którego się prognozuje do funkcji trendu, a następnie dodanie odpowiedniego wskaźnika sezonowości:</p>
<p><span class="math display">\[\hat{y}_{T}^{P}=\hat{y} + So_i=a_1 \cdot T + a_0 + So_i\]</span></p>
<p>Interesuje nas prognozowane zużycie energii w IV kwartale 2008 roku. Ten okres przyjmuje wartość <span class="math inline">\(t=24\)</span>, natomiast wskaźnik sezonowości dla czwartego kwartału jest równy 0,81 MWh. Powyższe wartości podstawiamy do wzoru:</p>
<p><span class="math display">\[\hat{y}_{24}^{P}=0,15 \cdot 24 + 2,99 + 0,81 = 7,4\]</span></p>
<p>co oznacza, że prognozowane zużycie energii w IV kwartale 2008 roku wyniesie 7,4 MWh.</p>
</div>
<div id="model-multiplikatywny" class="section level2">
<h2><span class="header-section-number">6.3</span> Model multiplikatywny</h2>
<p>W modelu multiplikatywnym zamiast różnic pomiędzy wartościami teoretycznymi a modelowymi oblicza się ich iloraz zgodnie ze wzorem:</p>
<p><span class="math display">\[S^i_t=\frac{y_t}{\hat{y}_t}\]</span></p>
<p>Następnie dla każdego z analizowanych podokresów (półroczy, kwartałów, miesięcy) oblicza się surowe wskaźniki sezonowości uśredniając wyznaczone wcześniej ilorazy:</p>
<p><span class="math display">\[S_i=\frac{\sum\limits_{i=1}^{m}{S_t^i}}{p}\]</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\(m\)</span> — liczba podokresów (półroczy, kwartałów, miesięcy),</li>
<li><span class="math inline">\(p\)</span> — liczba analizowanych lat.</li>
</ul>
<p>W analizowanym przez nas przykładzie musimy wyznaczyć surowe wskaźniki sezonowości dla każdego kwartału. W przypadku sezonowości multiplikatywnej zależność oznaczająca, że wskaźniki sezonowości są wolne od wahań przypadkowych jest wyrażona następująco: <span class="math inline">\(\sum\limits_{i=1}^{m}{S_i}=m\)</span>. W praktyce jednak rzadko zdarza się taka sytuacja. W takim przypadku należy jeszcze wyznaczyć współczynnik korygujący zgodnie z wzorem:</p>
<p><span class="math display">\[k=\frac{\sum\limits_{i=1}^{m}{S_i}}{m}\]</span></p>
<p>a następnie skorygować surowe wskaźniki sezonowości według formuły</p>
<p><span class="math display">\[So_{i}=S_i/k\]</span></p>
<p>otrzymując tzw. oczyszczone wskaźniki sezonowości, które informują o średnich odchyleniach od funkcji trendu w poszczególnych podokresach. Dla tych wskaźników zachodzi zależność: <span class="math inline">\(\sum\limits_{i=1}^{m}{So_{i}}=m\)</span>. W przykładzie 2 oczyszczone wskaźniki sezonowości możemy zapisać w postaci procentowej i dla poszczególnych kwartałów są równe:</p>
<table>
<colgroup>
<col width="7%" />
<col width="6%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th>Wskaźnik</th>
<th>Wartość</th>
<th>Interpretacja</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(So_{1}\)</span></td>
<td>96,5%</td>
<td>w pierwszych kwartałach lat 2003–2005 rzeczywiste przewozy były średnio o 3,5% niższe niż wynika to z funkcji trendu</td>
</tr>
<tr class="even">
<td><span class="math inline">\(So_{2}\)</span></td>
<td>100,1%</td>
<td>w drugich kwartałach lat 2003–2005 rzeczywiste przewozy były średnio o 0,1% wyższe niż wynika to z funkcji trendu</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(So_{3}\)</span></td>
<td>108,9%</td>
<td>w trzecich kwartałach lat 2003–2005 rzeczywiste przewozy były średnio o 8,9% wyższe niż wynika to z funkcji trendu</td>
</tr>
<tr class="even">
<td><span class="math inline">\(So_{4}\)</span></td>
<td>94,5%</td>
<td>w czwartych kwartałach lat 2003–2005 rzeczywiste przewozy były średnio o 5,5% niższe niż wynika to z funkcji trendu</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>400,00%</td>
<td>wskaźniki sezonowości są wolne od wahań przypadkowych</td>
</tr>
</tbody>
</table>
<p>Kolejnym etapem analizy jest wyznaczenie zmodyfikowanych wartości teoretycznych uwzględniających sezonowość. Te wartości oznaczane jako <span class="math inline">\(\hat{y}^*\)</span> uzyskujemy mnożąc wartości teoretyczne (<span class="math inline">\(\hat{y}\)</span>) odpowiednie dla poszczególnych podokresów przez oczyszczone wskaźniki sezonowości <span class="math inline">\(So_i\)</span>. Formalny zapis jest następujący:</p>
<p><span class="math display">\[\hat{y}^*=\hat{y} \cdot So_i\]</span></p>
<p>Wartości <span class="math inline">\(\hat{y}^*\)</span> przedstawione na wykresie już znacznie lepiej pasują do posiadanych danych empirycznych:</p>
<div class="figure">
<img src="img/przyklad2_sezon.png" alt="Przewóz ładunków - trend z sezonowością" />
<p class="caption">Przewóz ładunków - trend z sezonowością</p>
</div>
<p>Na podstawie tak zmodyfikowanego modelu można prognozować przyszłe wartości z dużo większą precyzją. Prognozowanie w modelu multiplikatywnym polega na podstawieniu numeru okresu dla którego się prognozuje do funkcji trendu, a następnie przemnożenie przez odpowiedni wskaźnik sezonowości:</p>
<p><span class="math display">\[\hat{y}_{T}^{P}=\hat{y} \cdot So_i=(a_1 \cdot T + a_0) \cdot So_i\]</span></p>
<p>Interesuje nas prognozowane zużycie energii w III kwartale 2006 roku. Ten okres przyjmuje wartość <span class="math inline">\(t=15\)</span>, natomiast wskaźnik sezonowości dla kwartału trzeciego jest równy 108,9%. Powyższe wartości podstawiamy do wzoru:</p>
<p><span class="math display">\[\hat{y}_{15}^{P}=(0,38 \cdot 15 + 25,13) \cdot 108,9\% = 33,6\]</span></p>
<p>co oznacza, że prognozowane przewozy ładunków w III kwartale 2006 roku wyniosą 33,6 mln ton.</p>
</div>
<div id="ocena-jakosci" class="section level2">
<h2><span class="header-section-number">6.4</span> Ocena jakości</h2>
<p>Ostatnim elementem analizy sezonowości jest ocena jakości otrzymanego modelu. W takim przypadku nie wyznaczamy współczynnika <span class="math inline">\(R^2\)</span> ponieważ z definicji dotyczy on wyłącznie zależności liniowej. Główną miarą jakości będzie odchylenie standardowe składnika resztowego z uwzględnieniem sezonowości:</p>
<p><span class="math display">\[S_u^*=\sqrt{\frac{\sum\limits_{t=1}^{n}{(y_t-\hat{y}_t^*)^2}}{n-2}}\]</span></p>
<p>Licznik odchylenia standardowego zawiera sumę kwadratów odchyleń wartości empirycznych (<span class="math inline">\(y_t\)</span>) od wartości modelowych z sezonowością (<span class="math inline">\(\hat{y}_t^*\)</span>). Nie ma już tutaj znaczenia czy model był addytywny czy multiplikatywny.</p>
<p>W przykładzie pierwszym <span class="math inline">\(S_u^*\)</span> wynosiło 0,16 MWh, co oznacza, że rzeczywiste zużycie energii różni się od zużycia teoretycznego wyznaczonego na podstawie szeregu czasowego średnio o +/- 0,16 MWh. Z kolei w przykładzie drugim <span class="math inline">\(S_u^*\)</span> wynosiło 0,74 mln ton, a co za tym idzie rzeczywiste przewozy różnią się od przewozów teoretycznych uzyskanych w oparciu o model szeregu czasowego średnio o +/- 0,74 mln ton.</p>
</div>
<div id="bad-prognozy" class="section level2">
<h2><span class="header-section-number">6.5</span> Błąd prognozy</h2>
<p>Wyliczona wartość <span class="math inline">\(S_u^*\)</span> niezbędna jest przy wyznaczaniu błędu prognozy zgodnie ze wzorem:</p>
<p><span class="math display">\[D(y_{T}^{P})=S_u^{*}\sqrt{1+\frac{1}{n}+\frac{(T-\bar{t})^2}{\sum\limits_{t=1}^{n}{(t-\bar{t})^2}}}\]</span></p>
<p>w którym uwzględniamy możliwość wzrostu tego błędu wraz z oddalaniem się od zakresu danych, które posiadamy.</p>
<p>Dla analizowanych przykładów otrzymano następujące błędy prognozy:</p>
<ul>
<li>przykład 1 — zużycie energii</li>
</ul>
<p>Przy prognozie dla IV kwartału 2008 roku</p>
<p><span class="math display">\[D(y_{24}^{P})=0,29\]</span></p>
<p>co oznacza, że prognozowane zużycie energii w IV kwartale 2008 roku wyniesie 7,4 +/- 0,29 MWh.
- przykład 2 — przewóz ładunków</p>
<p>Przy prognozie dla III kwartału 2006 roku</p>
<p><span class="math display">\[D(y_{24}^{P})=0,93\]</span></p>
<p>co oznacza, że prognozowane przewozy w III kwartale 2006 roku wyniosą 33,6 +/- 0,93 mln ton.</p>
<p>Na podstawie otrzymanych prognoz oraz ich błędów można wyznaczyć przedziały, w których spodziewamy się wartości rzeczywistej.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regresja.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analiza-szeregu-dynamicznego.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["KS-Statystyka_opisowa.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
